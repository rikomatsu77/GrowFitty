<h1 class="text-2xl font-bold text-[#2D4F4B] text-center mb-8">コーディネート詳細</h1>

<div class="max-w-4xl mx-auto">
<div class="relative post bg-[#FFFCF4] border border-[#F0EAD6] rounded-lg p-6 mb-6 shadow">
  <!-- 投稿者名 -->
  <p class="text-sm text-[#7A736A] mb-2">投稿者: <%= @post.user.user_name %></p>

  <!-- 編集・削除アイコン（投稿者本人のみ表示） -->
  <% if user_signed_in? && current_user == @post.user %>
  <div class="absolute top-4 right-4 flex gap-3 text-[#4AA398]">
    <%= link_to edit_post_path(@post), title: "編集", class: "hover:text-[#2D4F4B]" do %>
      <i class="fas fa-edit fa-lg"></i>
    <% end %>
    <%= link_to post_path(@post),
        data: { turbo_method: :delete, turbo_confirm: "本当に削除しますか？" },
        class: "hover:text-red-600", title: "削除" do %>
      <i class="fas fa-trash-alt fa-lg"></i>
    <% end %>
  </div>
<% end %>

  <!-- 画像表示 -->
  <div class="w-full h-60 bg-gray-50 rounded-lg overflow-hidden shadow-sm mb-4 flex items-center justify-center">
  <% if @post.post_image.present? %>
    <%= image_tag @post.post_image.url,
      alt: "#{@post.title}の投稿画像",
      class: "max-w-full max-h-full object-contain"  %>
  <% else %>
    <%= image_tag "post_placeholder.png",
      alt: "投稿画像なし",
      class: "max-w-full max-h-full object-contain"  %>
  <% end %>
  </div>

  <!-- タイトル・本文・ブックマークエリア -->
  <div class="content-area">
    <div class="flex items-start justify-between mb-2">
      <div class="flex-1">
        <% if @post.title.present? %>
          <h2 class="text-xl font-semibold text-[#3F8378]">
            <%= @post.title %>
          </h2>
        <% end %>
      </div>

      <!-- ブックマークボタン（他人の投稿のみ） -->
      <% if user_signed_in? && !current_user.own?(@post) %>
        <div class="ml-4 flex-shrink-0">
          <%= render "bookmark_buttons", post: @post %>
        </div>
      <% end %>
    </div>

    <!-- 本文 -->
    <% if @post.body.present? %>
      <p class="text-[#4A6F6A] mb-4">
        <%= @post.body %>
      </p>
    <% end %>
  </div>

    <!-- タグ表示 -->
      <% if @post.tags.any? %>
        <div class="mb-6">
          <h2 class="text-lg font-semibold text-[#2D4F4B] mb-3">
            <span class="inline-flex items-center">
              <span class="text-xl mr-2">🏷️</span>
              タグ
            </span>
          </h2>
          <div class="flex flex-wrap gap-2">
            <% @post.tags.each do |tag| %>
              <%= link_to posts_path(tag: tag.name),
                  class: "inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-[#F8FFFE] border border-[#4AA398] text-[#2D4F4B] hover:bg-[#4AA398] hover:text-white transition-colors duration-200" do %>
                <span class="mr-1">#</span><%= tag.name %>
              <% end %>
            <% end %>
          </div>
          <p class="text-xs text-[#7A736A] mt-2">
            💡 タグをクリックすると同じタグの投稿を見ることができます
          </p>
        </div>
      <% end %>


  <!-- コメントセクション -->
<div class="mt-8 border-t border-[#F0EAD6] pt-6">
  <!-- コメント表示 -->
  <% if @comments.any? %>
    <div class="mb-6">
      <h3 class="text-lg font-semibold text-[#2D4F4B] mb-4">
        コメント
      </h3>
      <div id="comments-list-<%= @post.id %>">
        <%= render @comments %>
      </div>
    </div>
  <% end %>

  <!-- コメント投稿フォーム -->
  <div id="comment-form-<%= @post.id %>">
    <%= render "comments/form", comment: @comment, post: @post %>
  </div>
</div>

  <p class="text-xs text-[#7A736A]">投稿日: <%= @post.created_at.strftime("%Y年%m月%d日 %H:%M") %></p>
</div>

  <!-- Xシェアボタン -->
  <div class="mt-4 pt-4 border-t border-[#F0EAD6] flex justify-center">
  <%= link_to "https://twitter.com/intent/tweet?text=#{CGI.escape(@post.title.present? ? @post.title : "コーディネートをシェアしたよ！")}&url=#{CGI.escape(request.original_url)}",
      target: "_blank",
      class: "inline-flex items-center gap-2 px-4 py-2 bg-black hover:bg-gray-800 text-white text-sm font-medium rounded-full transition-all duration-200 hover:scale-105 shadow-md hover:shadow-lg" do %>
    <%= image_tag "logo-white.png", alt: "X Logo", class: "w-4 h-4" %>
    <span>ポストする</span>
  <% end %>
</div>
</div>

<div class="flex flex-col md:flex-row justify-center items-center gap-4 mt-8">
  <%= link_to "一覧に戻る", posts_path, class: "btn px-6 py-3 w-64 text-lg shadow-lg text-white bg-[#4AA398] hover:bg-[#3e8f8e] transition-colors duration-200" %>
</div>
